class Vulnerability:
    def __init__(self, name, sources, sanitizers, sinks):
        self.name = name
        self.sources = sources
        self.sanitizers = sanitizers
        self.sinks = sinks


    def getType(self, func_name):
        if func_name in self.sources:
            return "source"
        elif func_name in self.sanitizers:
            return "sanitizer"
        elif func_name in self.sinks:
            return "sink"
        else:
            return "native"


    def addSources(self, sources):
        self.sources += sources
        self.sources = list(set(self.sources))

    def addSanitizers(self, sanitizers):
        self.sanitizers += sanitizers
        self.sanitizers = list(set(self.sanitizers))
    

    def addSinks(self, sinks):
        self.sinks += sinks
        self.sinks = list(set(self.sinks))

    def __str__(self):
        return "Name -> " + self.name + '\n\t' + "Sources -> " + str(self.sources) + '\n\t' \
         + "Sanitizers -> " + str(self.sanitizers) + '\n\t' + "Sinks -> " + str(self.sinks)
    
